<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "ad0c054ebd3de404d997d1707a513c70",
  "translation_date": "2025-09-17T18:06:41+00:00",
  "source_file": "Module05/04.SLMOps.Deployment.md",
  "language_code": "ar"
}
-->
# ุงููุณู 4: ุงููุดุฑ - ุชูููุฐ ูููุฐุฌ ุฌุงูุฒ ููุฅูุชุงุฌ

## ูุธุฑุฉ ุนุงูุฉ

ูุฐุง ุงูุฏููู ุงูุดุงูู ุณูุฑุดุฏู ุฎูุงู ุงูุนูููุฉ ุงููุงููุฉ ููุดุฑ ุงูููุงุฐุฌ ุงููุญุณููุฉ ูุงููููููุฉ ุจุงุณุชุฎุฏุงู Foundry Local. ุณูุบุทู ุชุญููู ุงููููุฐุฌุ ุชุญุณูู ุงูุชููููุ ูุชูููู ุงููุดุฑ ูู ุงูุจุฏุงูุฉ ุฅูู ุงูููุงูุฉ.

## ุงููุชุทูุจุงุช ุงูุฃุณุงุณูุฉ

ูุจู ุงูุจุฏุกุ ุชุฃูุฏ ูู ุชููุฑ ูุง ููู:

- โ ูููุฐุฌ ONNX ูุญุณูู ูุฌุงูุฒ ูููุดุฑ
- โ ุฌูุงุฒ ููุจููุชุฑ ูุนูู ุจูุธุงู Windows ุฃู Mac
- โ Python 3.10 ุฃู ุฃุนูู
- โ ุฐุงูุฑุฉ RAM ูุชุงุญุฉ ูุง ุชูู ุนู 8GB
- โ Foundry Local ูุซุจุช ุนูู ูุธุงูู

## ุงูุฌุฒุก 1: ุฅุนุฏุงุฏ ุงูุจูุฆุฉ

### ุชุซุจูุช ุงูุฃุฏูุงุช ุงููุทููุจุฉ

ุงูุชุญ ูุงูุฐุฉ ุงูุฃูุงูุฑ (Command Prompt ุนูู Windowsุ Terminal ุนูู Mac) ููู ุจุชุดุบูู ุงูุฃูุงูุฑ ุงูุชุงููุฉ ุจุงูุชุณูุณู:

```bash
# Update transformers library to the latest version
pip install transformers -U

# Install Microsoft Olive (model conversion tool)
pip install git+https://github.com/microsoft/Olive.git

# Install ONNX Runtime GenAI
git clone https://github.com/microsoft/onnxruntime-genai
cd onnxruntime-genai && python build.py --config Release
pip install {Your build release path}/onnxruntime_genai-0.9.0.dev0-cp311-cp311-linux_x86_64.whl

# Install additional dependencies
pip install onnx onnxruntime numpy
```

โ๏ธ **ููุงุญุธุฉ ูููุฉ**: ุณุชุญุชุงุฌ ุฃูุถูุง ุฅูู ุฅุตุฏุงุฑ CMake 3.31 ุฃู ุฃุญุฏุซุ ูุงูุฐู ูููู ุชูุฒููู ูู [cmake.org](https://cmake.org/download/).

## ุงูุฌุฒุก 2: ุชุญููู ุงููููุฐุฌ ูุชููููู

### ุงุฎุชูุงุฑ ุงูุชูุณูู ุงูููุงุณุจ

ุจุงููุณุจุฉ ููููุงุฐุฌ ุงูุตุบูุฑุฉ ุงููุญุณููุฉ ููุบุงุชุ ููุตู ุจุงุณุชุฎุฏุงู **ุชูุณูู ONNX** ูุฃูู ูููุฑ:

- ๐ ุชุญุณูู ุงูุฃุฏุงุก ุจุดูู ุฃูุถู
- ๐ง ูุดุฑ ูุณุชูู ุนู ุงูุฃุฌูุฒุฉ
- ๐ญ ูุฏุฑุงุช ุฌุงูุฒุฉ ููุฅูุชุงุฌ
- ๐ฑ ุชูุงูู ุนุจุฑ ุงูุฃูุธูุฉ ุงููุฎุชููุฉ

### ุงูุทุฑููุฉ ุงูุฃููู: ุงูุชุญููู ุจุฃูุฑ ูุงุญุฏ (ููุตู ุจู)

ุงุณุชุฎุฏู ุงูุฃูุฑ ุงูุชุงูู ูุชุญููู ุงููููุฐุฌ ุงููุญุณูู ูุจุงุดุฑุฉ:

```bash
olive auto-opt \
    --model_name_or_path /path/to/your/finetuned/model \
    --device cpu \
    --provider CPUExecutionProvider \
    --use_model_builder \
    --precision int4 \
    --output_path models/your-model-name/onnx \
    --log_level 1
```

**ุดุฑุญ ุงููุนููุงุช:**
- `--model_name_or_path`: ูุณุงุฑ ุงููููุฐุฌ ุงููุญุณูู
- `--device cpu`: ุงุณุชุฎุฏุงู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ููุชุญุณูู
- `--precision int4`: ุงุณุชุฎุฏุงู ุชูููู INT4 (ุชูููู ุงูุญุฌู ุจูุณุจุฉ ุชูุงุฑุจ 75%)
- `--output_path`: ูุณุงุฑ ุงูุฅุฎุฑุงุฌ ูููููุฐุฌ ุงููุญููู

### ุงูุทุฑููุฉ ุงูุซุงููุฉ: ููุฌ ููู ุงูุชูููู (ูููุณุชุฎุฏููู ุงููุชูุฏููู)

ูู ุจุฅูุดุงุก ููู ุชูููู ุจุงุณู `finetuned_conversion_config.json`:

```json
{
    "input_model": {
        "type": "HfModel",
        "model_path": "/path/to/your/finetuned/model",
        "task": "text-generation"
    },
    "systems": {
        "local_system": {
            "type": "LocalSystem",
            "accelerators": [
                {
                    "execution_providers": [
                        "CPUExecutionProvider"
                    ]
                }
            ]
        }
    },
    "passes": {
        "builder": {
            "type": "ModelBuilder",
            "config": {
                "precision": "int4",
                "quantization_config": {
                    "block_size": 128,
                    "is_symmetric": false
                }
            }
        }
    },
    "host": "local_system",
    "target": "local_system",
    "cache_dir": "cache",
    "output_dir": "models/output/your-finetuned-model-onnx"
}
```

ุซู ูู ุจุชุดุบูู:

```bash
olive run --config ./finetuned_conversion_config.json
```

### ููุงุฑูุฉ ุฎูุงุฑุงุช ุงูุชูููู

| ุงูุฏูุฉ       | ุญุฌู ุงูููู       | ุณุฑุนุฉ ุงูุงุณุชูุชุงุฌ | ุฌูุฏุฉ ุงููููุฐุฌ | ุงูุงุณุชุฎุฏุงู ุงูููุตู ุจู       |
|-------------|-----------------|-----------------|-------------|---------------------------|
| FP16        | ุงูุฃุณุงุณ ร 0.5    | ุณุฑูุน           | ุงูุฃูุถู      | ุงูุฃุฌูุฒุฉ ุนุงููุฉ ุงูุฃุฏุงุก      |
| INT8        | ุงูุฃุณุงุณ ร 0.25   | ุณุฑูุน ุฌุฏูุง      | ุฌูุฏ         | ุฎูุงุฑ ูุชูุงุฒู               |
| INT4        | ุงูุฃุณุงุณ ร 0.125  | ุงูุฃุณุฑุน         | ููุจูู       | ุงูุฃุฌูุฒุฉ ูุญุฏูุฏุฉ ุงูููุงุฑุฏ    |

๐ก **ุงูุชูุตูุฉ**: ุงุจุฏุฃ ุจุชูููู INT4 ูููุดุฑ ุงูุฃูู. ุฅุฐุง ูู ุชูู ุงูุฌูุฏุฉ ูุฑุถูุฉุ ุฌุฑุจ INT8 ุฃู FP16.

## ุงูุฌุฒุก 3: ุชูููู ูุดุฑ Foundry Local

### ุฅูุดุงุก ุชูููู ุงููููุฐุฌ

ุงูุชูู ุฅูู ุฏููู ุงูููุงุฐุฌ ูู Foundry Local:

```bash
foundry cache cd ./models/
```

ูู ุจุฅูุดุงุก ูููู ุฏููู ุงููููุฐุฌ ุงูุฎุงุต ุจู:

```bash
mkdir -p ./models/custom/your-finetuned-model
```

ูู ุจุฅูุดุงุก ููู ุงูุชูููู `inference_model.json` ูู ุฏููู ุงููููุฐุฌ ุงูุฎุงุต ุจู:

```json
{
  "Name": "your-finetuned-model-int4",
  "Description": "Fine-tuned quantized model",
  "Version": "1.0",
  "PromptTemplate": {
    "system": "<|im_start|>system\n{Content}<|im_end|>",
    "user": "<|im_start|>user\n{Content}<|im_end|>",
    "assistant": "<|im_start|>assistant\n{Content}<|im_end|>",
    "prompt": "<|im_start|>user\n{Content}<|im_end|>\n<|im_start|>assistant"
  },
  "ModelConfig": {
    "max_length": 2048,
    "temperature": 0.7,
    "top_p": 0.9,
    "repetition_penalty": 1.1
  }
}
```

### ุชููููุงุช ุงูููุงูุจ ุงูุฎุงุตุฉ ุจุงูููุงุฐุฌ

#### ูููุงุฐุฌ ุณูุณูุฉ Qwen:

```json
{
  "Name": "qwen-finetuned-int4",
  "PromptTemplate": {
    "system": "<|im_start|>system\n{Content}<|im_end|>",
    "user": "<|im_start|>user\n{Content}<|im_end|>",
    "assistant": "<|im_start|>assistant\n{Content}<|im_end|>",
    "prompt": "<|im_start|>user\n{Content}<|im_end|>\n<|im_start|>assistant"
  }
}
```

## ุงูุฌุฒุก 4: ุงุฎุชุจุงุฑ ุงููููุฐุฌ ูุชุญุณููู

### ุงูุชุญูู ูู ุชุซุจูุช ุงููููุฐุฌ

ุชุญูู ููุง ุฅุฐุง ูุงู Foundry Local ููููู ุงูุชุนุฑู ุนูู ุงููููุฐุฌ ุงูุฎุงุต ุจู:

```bash
foundry cache ls
```

ูุฌุจ ุฃู ุชุฑู `your-finetuned-model-int4` ูู ุงููุงุฆูุฉ.

### ุจุฏุก ุงุฎุชุจุงุฑ ุงููููุฐุฌ

```bash
foundry model run your-finetuned-model-int4
```

### ููุงุณ ุงูุฃุฏุงุก

ุฑุงูุจ ุงูููุงููุณ ุงูุฑุฆูุณูุฉ ุฃุซูุงุก ุงูุงุฎุชุจุงุฑ:

1. **ููุช ุงูุงุณุชุฌุงุจุฉ**: ููุงุณ ูุชูุณุท ุงูููุช ููู ุงุณุชุฌุงุจุฉ
2. **ุงุณุชููุงู ุงูุฐุงูุฑุฉ**: ูุฑุงูุจุฉ ุงุณุชุฎุฏุงู RAM
3. **ุงุณุชุฎุฏุงู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ**: ุงูุชุญูู ูู ุชุญููู ุงููุนุงูุฌ
4. **ุฌูุฏุฉ ุงูุฅุฎุฑุงุฌ**: ุชูููู ูุฏู ููุงุกูุฉ ูุชูุงุณู ุงูุงุณุชุฌุงุจุฉ

### ูุงุฆูุฉ ุงูุชุญูู ูู ุงูุชุญูู ูู ุงูุฌูุฏุฉ

- โ ุงููููุฐุฌ ูุณุชุฌูุจ ุจุดูู ููุงุณุจ ูุงุณุชูุณุงุฑุงุช ุงููุฌุงู ุงููุญุณูู
- โ ุชูุณูู ุงูุงุณุชุฌุงุจุฉ ูุชุทุงุจู ูุน ูููู ุงูุฅุฎุฑุงุฌ ุงููุชููุน
- โ ูุง ุชูุฌุฏ ุชุณุฑูุจุงุช ุฐุงูุฑุฉ ุฃุซูุงุก ุงูุงุณุชุฎุฏุงู ุงููุทูู
- โ ุฃุฏุงุก ูุชุณู ุนุจุฑ ุฃุทูุงู ุงููุฏุฎูุงุช ุงููุฎุชููุฉ
- โ ุงูุชุนุงูู ุจุดูู ุตุญูุญ ูุน ุงูุญุงูุงุช ุงูุญุงูุฉ ูุงููุฏุฎูุงุช ุบูุฑ ุงูุตุงูุญุฉ

## ุงูููุฎุต

ุชูุงูููุง! ููุฏ ุฃูููุช ุจูุฌุงุญ:

- โ ุชุญููู ุชูุณูู ุงููููุฐุฌ ุงููุญุณูู
- โ ุชุญุณูู ุชูููู ุงููููุฐุฌ
- โ ุชูููู ูุดุฑ Foundry Local
- โ ุถุจุท ุงูุฃุฏุงุก ูุญู ุงููุดููุงุช

---

**ุฅุฎูุงุก ุงููุณุคูููุฉ**:  
ุชู ุชุฑุฌูุฉ ูุฐุง ุงููุณุชูุฏ ุจุงุณุชุฎุฏุงู ุฎุฏูุฉ ุงูุชุฑุฌูุฉ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู [Co-op Translator](https://github.com/Azure/co-op-translator). ุจูููุง ูุณุนู ูุชุญููู ุงูุฏูุฉุ ูุฑุฌู ุงูุนูู ุฃู ุงูุชุฑุฌูุงุช ุงูุขููุฉ ูุฏ ุชุญุชูู ุนูู ุฃุฎุทุงุก ุฃู ูุนูููุงุช ุบูุฑ ุฏูููุฉ. ูุฌุจ ุงุนุชุจุงุฑ ุงููุณุชูุฏ ุงูุฃุตูู ุจูุบุชู ุงูุฃุตููุฉ ุงููุตุฏุฑ ุงูููุซูู. ููุญุตูู ุนูู ูุนูููุงุช ุญุงุณูุฉุ ูููุตู ุจุงูุงุณุชุนุงูุฉ ุจุชุฑุฌูุฉ ุจุดุฑูุฉ ุงุญุชุฑุงููุฉ. ูุญู ุบูุฑ ูุณุคูููู ุนู ุฃู ุณูุก ููู ุฃู ุชูุณูุฑุงุช ุฎุงุทุฆุฉ ุชูุดุฃ ุนู ุงุณุชุฎุฏุงู ูุฐู ุงูุชุฑุฌูุฉ.