<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "20892f7994d9e5d2473ad19dfa93cf6d",
  "translation_date": "2025-09-18T22:52:30+00:00",
  "source_file": "Module02/01.PhiFamily.md",
  "language_code": "lt"
}
-->
# 1 skyrius: Microsoft Phi modeliÅ³ Å¡eimos pagrindai

Microsoft Phi modeliÅ³ Å¡eima Å¾ymi paradigmos pokytÄ¯ dirbtinio intelekto srityje, Ä¯rodydama, kad kompaktiÅ¡ki ir efektyvÅ«s modeliai gali pasiekti Ä¯spÅ«dingus rezultatus, tuo paÄiu bÅ«dami Å¾ymiai maÅ¾iau resursÅ³ reikalaujantys nei tradiciniai dideli kalbos modeliai. Svarbu suprasti, kaip Phi Å¡eima leidÅ¾ia pasiekti galingas AI galimybes su maÅ¾esniais skaiÄiavimo reikalavimais, iÅ¡laikant aukÅ¡tÄ… naÅ¡umÄ… Ä¯vairiose uÅ¾duotyse.

## IÅ¡tekliai kÅ«rÄ—jams

### Azure AI Foundry Model Catalog
Phi modeliÅ³ Å¡eima (iÅ¡skyrus Phi-silica) yra pasiekiama per [Azure AI Foundry Model Catalog](https://ai.azure.com/explore/models?q=phi), leidÅ¾iant kÅ«rÄ—jams lengvai pasiekti, pritaikyti ir diegti Å¡iuos modelius savo programose. Katalogas suteikia supaprastintÄ… bÅ«dÄ… eksperimentuoti su skirtingais Phi variantais ir integruoti juos Ä¯ savo projektus.

### Azure AI Foundry
Phi modelius galite diegti ir eksperimentuoti su jais naudodami [Azure AI Foundry](https://ai.azure.com), kuris suteikia visapusiÅ¡kÄ… aplinkÄ… AI sprendimÅ³ kÅ«rimui, testavimui ir diegimui su minimaliu nustatymu.

### Foundry Local
Vietiniam kÅ«rimui ir diegimui iÅ¡bandykite [Microsoft Foundry Local](https://github.com/microsoft/foundry-local), kuris leidÅ¾ia paleisti Phi modelius jÅ«sÅ³ kÅ«rimo kompiuteryje su optimizuotomis konfigÅ«racijomis.

### Dokumentacijos iÅ¡tekliai
- [Microsoft Research: Phi Model Technical Reports](https://ai.azure.com/labs/projects/phi-4)
- [Phi Cookbook](https://aka.ms/phicookbook)

## Ä®vadas

Å ioje pamokoje nagrinÄ—sime Microsoft Phi modeliÅ³ Å¡eimÄ… ir jos pagrindines koncepcijas. Aptarsime Phi Å¡eimos evoliucijÄ…, inovatyvius mokymo metodus, kurie daro Phi modelius efektyviais, pagrindinius Å¡eimos variantus ir praktinius pritaikymus Ä¯vairiose situacijose.

## Mokymosi tikslai

Pamokos pabaigoje galÄ—site:

- Suprasti Microsoft Phi modeliÅ³ Å¡eimos dizaino filosofijÄ… ir evoliucijÄ….
- Identifikuoti pagrindines inovacijas, leidÅ¾ianÄias Phi modeliams pasiekti aukÅ¡tÄ… naÅ¡umÄ… su maÅ¾esniu parametrÅ³ skaiÄiumi.
- AtpaÅ¾inti skirtingÅ³ Phi modeliÅ³ variantÅ³ privalumus ir trÅ«kumus.
- Taikyti Å¾inias apie Phi modelius, kad pasirinktumÄ—te tinkamus variantus realioms situacijoms.

## Tradicinio AI modelio paradigma

TradiciÅ¡kai aukÅ¡tas naÅ¡umas natÅ«ralios kalbos apdorojime reikalavo masyviÅ³ kalbos modeliÅ³ su milijardais ar Å¡imtais milijardÅ³ parametrÅ³. Organizacijos paprastai diegia Å¡iuos modelius galinguose GPU klasteriuose, naudodamos jÅ³ galimybes per API sÄ…sajas arba specializuotÄ… techninÄ™ infrastruktÅ«rÄ….

Å is metodas gerai veikia daugelyje programÅ³, taÄiau turi esminiÅ³ apribojimÅ³ praktinio diegimo scenarijuose. Tradicinis metodas apima modeliÅ³ naudojimÄ…, kurie reikalauja dideliÅ³ skaiÄiavimo resursÅ³, daug atminties ir reikÅ¡mingo energijos suvartojimo. Nors Å¡is metodas suteikia prieigÄ… prie paÅ¾angiausiÅ³ galimybiÅ³, jis sukuria priklausomybÄ™ nuo brangios techninÄ—s Ä¯rangos, didina eksploatavimo iÅ¡laidas ir riboja diegimo lankstumÄ….

## Efektyvaus AI diegimo iÅ¡Å¡Å«kis

Efektyvesnio AI poreikis tampa vis svarbesnis Ä¯vairiose situacijose. PavyzdÅ¾iui, programos, reikalaujanÄios vietinio diegimo dÄ—l privatumo prieÅ¾asÄiÅ³, sÄ…naudÅ³ jautrios Ä¯gyvendinimo, kur debesÅ³ API iÅ¡laidos tampa nepriimtinos, kraÅ¡tinio skaiÄiavimo scenarijai su ribotais techninÄ—s Ä¯rangos resursais arba realaus laiko programos, kuriose svarbus atsako greitis.

### Pagrindiniai diegimo apribojimai

Tradiciniai dideliÅ³ modeliÅ³ diegimai susiduria su keliais esminiais apribojimais, kurie riboja jÅ³ praktinÄ¯ pritaikymÄ…:

- **SÄ…naudÅ³ apribojimai**: DidelÄ—s skaiÄiavimo sÄ…naudos daro nuolatinÄ¯ diegimÄ… brangÅ³ daugeliui organizacijÅ³.
- **ResursÅ³ apribojimai**: Ribota prieiga prie aukÅ¡tos klasÄ—s GPU infrastruktÅ«ros riboja diegimo galimybes.
- **Privatumo reikalavimai**: Jautrios programos reikalauja vietinio apdorojimo, kad bÅ«tÅ³ iÅ¡laikytas duomenÅ³ privatumas.
- **Latencijos jautrumas**: Realaus laiko programos reikalauja greitÅ³ atsakymÅ³ be debesÅ³ ryÅ¡io vÄ—lavimÅ³.

## Microsoft Phi modeliÅ³ filosofija

Microsoft Phi modeliÅ³ Å¡eima Å¾ymi esminÄ¯ pokytÄ¯ AI modeliÅ³ dizaino filosofijoje, pirmenybÄ™ teikiant efektyvumui ir praktiniam diegimui, tuo paÄiu iÅ¡laikant stiprias naÅ¡umo charakteristikas. Phi modeliai tai pasiekia per inovatyvias architektÅ«ras, aukÅ¡tos kokybÄ—s mokymo metodikas ir specializuotas optimizavimo technikas.

Phi Å¡eima apima Ä¯vairius metodus, skirtus maksimaliai padidinti naÅ¡umÄ… per parametrÄ…, leidÅ¾iant diegti standartinÄ—je techninÄ—je Ä¯rangoje, tuo paÄiu suteikiant reikÅ¡mingas AI galimybes. Tikslas yra iÅ¡laikyti konkurencingÄ… naÅ¡umÄ…, tuo paÄiu drastiÅ¡kai sumaÅ¾inant skaiÄiavimo reikalavimus, atminties naudojimÄ… ir eksploatavimo iÅ¡laidas.

### Pagrindiniai Phi dizaino principai

Phi modeliai yra sukurti remiantis keliais pagrindiniais principais, kurie juos iÅ¡skiria iÅ¡ tradiciniÅ³ dideliÅ³ kalbos modeliÅ³:

- **Efektyvumas pirmiausia**: Optimizuoti maksimaliai naÅ¡umui per parametrÄ…, o ne absoliuÄiam mastui.
- **KokybiÅ¡kas mokymas**: DÄ—mesys aukÅ¡tos kokybÄ—s, kruopÅ¡Äiai atrinktiems mokymo duomenims, o ne masyviems duomenÅ³ rinkiniams.
- **Diegimo lankstumas**: Sukurti veikti efektyviai Ä¯vairiose techninÄ—s Ä¯rangos konfigÅ«racijose.
- **Specializuotos galimybÄ—s**: DaÅ¾nai optimizuoti specifinÄ—ms uÅ¾duotims ar sritims, kad bÅ«tÅ³ maksimaliai efektyvÅ«s.

## PagrindinÄ—s technologijos, leidÅ¾ianÄios Phi Å¡eimÄ…

### â€VadovÄ—lioâ€œ mokymo metodas

Vienas iÅ¡ revoliucingiausiÅ³ Phi Å¡eimos aspektÅ³ yra â€vadovÄ—lio kokybÄ—sâ€œ mokymo metodika. Vietoj mokymo su masyviu kiekiu nefiltruotÅ³ interneto duomenÅ³, Phi modeliai naudoja kruopÅ¡Äiai atrinktÄ…, aukÅ¡tos kokybÄ—s edukacinÄ¯ turinÄ¯, skirtÄ… efektyviai mokyti logikos, matematikos, kodavimo ir bendrÅ³jÅ³ Å¾iniÅ³.

Å is metodas veikia kuriant sintetinÄ¯ edukacinÄ¯ turinÄ¯, kuris atspindi aukÅ¡tos kokybÄ—s vadovÄ—lius ir akademinÄ™ medÅ¾iagÄ…. Mokymo duomenys yra specialiai sukurti, kad bÅ«tÅ³ pedagogiÅ¡kai tinkami, orientuoti Ä¯ aiÅ¡kius paaiÅ¡kinimus, Å¾ingsnis po Å¾ingsnio logikÄ… ir struktÅ«ruotÄ… Å¾iniÅ³ pateikimÄ….

### PaÅ¾angus logikos mokymas

Naujausi Phi modeliai Ä¯traukia sudÄ—tingas logikos mokymo metodikas, leidÅ¾ianÄias sprÄ™sti sudÄ—tingas daugiapakopes problemas. Å ios technikos apima:

**â€MÄ…stymo grandinÄ—sâ€œ mokymas**: Modeliai mokosi suskaidyti sudÄ—tingas problemas Ä¯ tarpinio logikos Å¾ingsnius, padarant jÅ³ problemÅ³ sprendimo procesÄ… skaidresnÄ¯ ir patikimesnÄ¯.

**Mastelio didinimas atsakymo metu**: Modeliai generuoja detalias logikos grandines, kurios atsakymo generavimo metu naudoja papildomus skaiÄiavimo resursus, kad pagerintÅ³ tikslumÄ….

**Mokymas ties galimybiÅ³ riba**: Mokymo duomenys yra specialiai parinkti, kad iÅ¡Å¡auktÅ³ modelÄ¯ ties jo dabartiniÅ³ galimybiÅ³ riba, skatinant mokytis sudÄ—tingÅ³ logikos modeliÅ³.

### ArchitektÅ«rinÄ—s inovacijos

Phi Å¡eima Ä¯traukia kelias architektÅ«rines optimizacijas, specialiai sukurtas efektyvumui:

**ParametrÅ³ efektyvumas**: KruopÅ¡Äiai parinktos architektÅ«ros, kurios maksimaliai iÅ¡naudoja kiekvienÄ… modelio parametrÄ….

**DaugiarÅ«Å¡is integravimas**: Efektyvus teksto, vaizdÅ³ ir kalbos apdorojimo galimybiÅ³ integravimas kompaktiÅ¡kose architektÅ«rose.

**TechninÄ—s Ä¯rangos optimizavimas**: Specializuoti variantai, optimizuoti specifinÄ—ms techninÄ—s Ä¯rangos platformoms ir diegimo scenarijams.

## TechninÄ—s Ä¯rangos optimizavimas Phi modeliams

Å iuolaikinÄ—s diegimo aplinkos naudoja Phi modeliÅ³ efektyvumÄ… Ä¯vairiose techninÄ—s Ä¯rangos konfigÅ«racijose:

### CPU optimizuotas diegimas

Phi modeliai yra sukurti veikti efektyviai tik CPU pagrindu veikianÄioje techninÄ—je Ä¯rangoje, leidÅ¾iant juos diegti standartinÄ—je kompiuterinÄ—je infrastruktÅ«roje be specializuotÅ³ AI akceleratoriÅ³.

### GPU pagreitinimas

Nors nereikalaujant galingÅ³ GPU, Phi modeliai gali pasinaudoti turimais GPU resursais, kad pagerintÅ³ naÅ¡umÄ…, suteikiant lankstumÄ… diegimo konfigÅ«racijose.

### KraÅ¡tiniÅ³ Ä¯renginiÅ³ integracija

Specializuoti variantai, tokie kaip Phi-3-Silica, yra optimizuoti specifinÄ—ms kraÅ¡tinio skaiÄiavimo platformoms, pasiekiant Ä¯spÅ«dingus efektyvumo rodiklius, tokius kaip 650 Å¾etonÅ³ per sekundÄ™ su tik 1.5W energijos suvartojimu.

## Phi modeliÅ³ Å¡eimos privalumai

### SÄ…naudÅ³ efektyvumas

Phi modeliai Å¾ymiai sumaÅ¾ina eksploatavimo iÅ¡laidas, reikalaudami Å¾ymiai maÅ¾iau skaiÄiavimo infrastruktÅ«ros, tuo paÄiu iÅ¡laikant konkurencingÄ… naÅ¡umÄ…. Tai daro AI prieinamÄ… organizacijoms su ribotais biudÅ¾etais arba didelÄ—s apimties programoms, kur svarbi kaina uÅ¾ vienÄ… uÅ¾klausÄ….

### Diegimo lankstumas

Phi modeliÅ³ efektyvumas leidÅ¾ia juos diegti Ä¯vairiose techninÄ—s Ä¯rangos konfigÅ«racijose, nuo asmeniniÅ³ neÅ¡iojamÅ³jÅ³ kompiuteriÅ³ iki Ä¯moniÅ³ serveriÅ³, suteikiant organizacijoms didesnÄ¯ lankstumÄ… jÅ³ AI infrastruktÅ«ros pasirinkimuose.

### Privatumas ir saugumas

Phi modeliÅ³ efektyvumas leidÅ¾ia vietinÄ¯ diegimÄ… privatumo jautrioms programoms, uÅ¾tikrinant, kad jautrÅ«s duomenys niekada nepaliks organizacijos kontrolÄ—s, tuo paÄiu suteikiant galingas AI galimybes.

### Realaus laiko naÅ¡umas

SumaÅ¾inti skaiÄiavimo reikalavimai reiÅ¡kia greitesnÄ¯ atsakymÅ³ generavimÄ…, leidÅ¾iant realaus laiko programoms, kurios reikalauja greitÅ³ atsakymÅ³, nekompromituojant AI galimybiÅ³ kokybÄ—s.

### Prieinamas AI

SumaÅ¾indami AI diegimo barjerus, Phi modeliai daro paÅ¾angias AI galimybes prieinamas organizacijoms su ribotais resursais, leidÅ¾iant maÅ¾esnÄ—ms komandoms ir individualiems kÅ«rÄ—jams pasinaudoti sudÄ—tingu kalbos supratimu.

## Praktiniai pavyzdÅ¾iai ir pritaikymo atvejai

PrieÅ¡ gilindamiesi Ä¯ techninÄ™ evoliucijÄ…, paÅ¾velkime Ä¯ keletÄ… konkreÄiÅ³ pavyzdÅ¾iÅ³, kÄ… Phi modeliai gali pasiekti:

### MatematinÄ—s logikos pavyzdys

Phi-4-mini-reasoning puikiai sprendÅ¾ia Å¾ingsnis po Å¾ingsnio matematines problemas. PavyzdÅ¾iui, paklausus â€Kaip iÅ¡sprÄ™sti 3*x^2+4*x+5=1?â€œ, modelis pateikia detalius logikos Å¾ingsnius:

```
<|system|>Your name is Phi, an AI math expert developed by Microsoft.<|end|>
<|user|>How to solve 3*x^2+4*x+5=1?<|end|>
<|assistant|>
I need to solve the quadratic equation 3xÂ² + 4x + 5 = 1.

First, let me rearrange this to standard form:
3xÂ² + 4x + 5 = 1
3xÂ² + 4x + 5 - 1 = 0  
3xÂ² + 4x + 4 = 0

Now I can use the quadratic formula: x = (-b Â± âˆš(bÂ² - 4ac)) / (2a)
Where a = 3, b = 4, c = 4

Let me calculate the discriminant:
bÂ² - 4ac = 4Â² - 4(3)(4) = 16 - 48 = -32

Since the discriminant is negative (-32), this equation has no real solutions.
The solutions are complex: x = (-4 Â± âˆš(-32)) / 6 = (-4 Â± 4iâˆš2) / 6 = (-2 Â± 2iâˆš2) / 3
```

### DaugiakalbÄ—s palaikymo pavyzdys

Phi-3.5-mini-instruct demonstruoja stiprias daugiakalbes galimybes Ä¯vairiomis kalbomis. Å tai pavyzdinis uÅ¾klausos formatas:

```
<|system|>You are a helpful assistant.<|end|>
<|user|>How to explain Internet for a medieval knight?<|end|>
<|assistant|>
Imagine, good sir knight, a vast network of invisible roads that span the entire realm and beyond. The Internet is like a magical system of messenger birds that can carry any message - be it text, images, or even moving pictures - instantly to any castle, village, or hamlet in the world.

Think of it as if every scribe's work could be copied and shared with thousands of people simultaneously, as if you could visit any library in any kingdom without leaving your chambers, or as if you could hold council with knights from distant lands as if they were sitting at your very table.

This "Internet" allows people to:
- Send messages faster than the swiftest horse
- Access knowledge from scholars across all kingdoms
- Trade goods without traveling to distant markets
- Share stories and news from lands you've never seen

'Tis like having a thousand scribes, merchants, and storytellers all working for you at once, good knight!
```

### DaugiarÅ«Å¡Ä—s galimybÄ—s pavyzdys

Phi-4-multimodal gali apdoroti tekstÄ…, vaizdus ir kalbÄ… vienu metu. Å tai keletas praktiniÅ³ pritaikymÅ³:

**KelioniÅ³ planavimas naudojant garso Ä¯vestÄ¯:**
Phi-4 Multimodal analizuoja kalbÄ…, kad padÄ—tÅ³ suplanuoti kelionÄ™ Ä¯ SietlÄ…, demonstruodamas paÅ¾angias garso apdorojimo ir rekomendacijÅ³ galimybes.

**MatematinÄ—s problemos sprendimas iÅ¡ vaizdÅ³:**
Phi-4 Multimodal sprendÅ¾ia sudÄ—tingas matematines problemas per vizualinÄ™ Ä¯vestÄ¯, demonstruodamas gebÄ—jimÄ… apdoroti ir sprÄ™sti lygtis, pateiktas vaizduose.

**FunkcijÅ³ kvietimo pavyzdys:**
Naudodami funkcijÅ³ kvietimÄ…, Phi-4-mini ir Phi-4-multimodal gali iÅ¡plÄ—sti savo teksto apdorojimo galimybes, integruodami paieÅ¡kos sistemas, jungdami Ä¯vairius Ä¯rankius ir daugiau. Kaip parodyta, modelis gali gauti â€Premier Leagueâ€œ rungtyniÅ³ informacijÄ… per Phi-4-mini, demonstruodamas gebÄ—jimÄ… sklandÅ¾iai sÄ…veikauti su iÅ¡oriniais duomenÅ³ Å¡altiniais.

### Kodo generavimo pavyzdys

Phi-4-multimodal gali generuoti struktÅ«rizuotÄ… projekto kodÄ…, remdamasis tiek vaizdo turiniu, tiek pateiktais uÅ¾klausos duomenimis, kaip parodyta Å¡iame praktiniame darbo procese:

1. Ä®kelkite vaizdÄ… su karkasu ar dizainu
2. Pateikite kontekstÄ… apie projekto reikalavimus
3. Modelis generuoja pilnas, funkcionalias kodo struktÅ«ras
4. Kodas gali bÅ«ti pritaikytas pagal specifines sistemas ar kalbas

### KraÅ¡tinio diegimo pavyzdys

Galime diegti kvantizuotÄ… modelÄ¯ kraÅ¡tiniuose Ä¯renginiuose. Naudodami Microsoft Olive ir ONNX GenAI Runtime, galime diegti Phi-4-mini Windows, iPhone, Android ir kituose Ä¯renginiuose. Å tai pavyzdys, veikiantis iPhone 12 Pro.

Diegimo procesas apima:
- Modelio kvantizavimÄ… mobiliajai optimizacijai
- ONNX vykdymo aplinkos integracijÄ… kryÅ¾minÄ—s platformos suderinamumui
- VietinÄ¯ apdorojimÄ… be interneto ryÅ¡io
- Realaus laiko naÅ¡umÄ… su minimaliu energijos suvartojimu

## Phi Å¡eimos evoliucija

### Phi-1 ir Phi-2: Pagrindiniai modeliai

Ankstyvieji Phi modeliai nustatÄ— pagrindinius principus, tokius kaip aukÅ¡tos kokybÄ—s mokymo duomenys ir efektyvios architektÅ«ros:

- **Phi-1 (1.3B parametrai)**: Ä®vedÄ— kruopÅ¡Äiai atrinktÅ³ mokymo duomenÅ³ koncepcijÄ… pagrindiniam kalbos supratimui ir kodo generavimui.
- **Phi-2 (2.7B parametrai)**: Pagerino logikos galimybes per sintetinÄ™ NLP duomenÅ³ ir kruopÅ¡Äiai filtruotÄ… interneto turinÄ¯.

### Phi-3 Å¡eima: Pagrindinis pritaikymas

Phi-3 serija Å¾ymÄ—jo proverÅ¾Ä¯ SLM galimybÄ—se su keliais specializuotais variantais:

- **Phi-3-mini (3.8B parametrai)**: Bendros kalbos uÅ¾duotys su iÅ¡skirtiniu efektyvumu, pranokstant modelius dvigubai didesnius.
- **Phi-3-small (7B parametrai)**: PaÅ¾angus naÅ¡umas, pranokstantis GPT-3.5 Turbo Ä¯vairiuose testuose.
- **Phi-3-medium (14B parametrai)**: Ä®monÄ—s lygio naÅ¡umas, pranokstantis Gemini 1.0 Pro.
- **Phi-3-vision (4.2B parametrai)**: DaugiarÅ«Å¡Ä—s galimybÄ—s vaizdÅ³ ir teksto apdoroj
Phi Å¡eima parodo, kad dirbtinio intelekto ateitis slypi ne tik kuriant didesnius modelius, bet ir kuriant protingesnius, efektyvesnius modelius, kurie gali veikti Ä¯vairiose techninÄ—s Ä¯rangos aplinkose, iÅ¡laikydami aukÅ¡tus naÅ¡umo standartus.

## KÅ«rimo ir integravimo pavyzdÅ¾iai

### Greitas startas su Transformers

Å tai kaip pradÄ—ti naudoti Phi modelius su Hugging Face Transformers biblioteka:

```python
from transformers import AutoModelForCausalLM, AutoTokenizer
import torch

# Load Phi-4-mini-instruct
model = AutoModelForCausalLM.from_pretrained(
    "microsoft/Phi-4-mini-instruct",
    torch_dtype=torch.bfloat16,
    trust_remote_code=True,
    attn_implementation="flash_attention_2"  # For optimized performance
)

tokenizer = AutoTokenizer.from_pretrained("microsoft/Phi-4-mini-instruct")

# Format your prompt using the chat template
messages = [
    {"role": "system", "content": "You are a helpful assistant."},
    {"role": "user", "content": "Explain quantum computing in simple terms."}
]

# Apply chat template
input_text = tokenizer.apply_chat_template(messages, tokenize=False)
inputs = tokenizer(input_text, return_tensors="pt")

# Generate response
with torch.no_grad():
    outputs = model.generate(**inputs, max_new_tokens=200, temperature=0.7)
    
response = tokenizer.decode(outputs[0], skip_special_tokens=True)
print(response)
```

### Pavyzdys, kaip pritaikyti modelÄ¯

Å is pavyzdys parodo, kaip pritaikyti Phi-4-mini-instruct konkreÄioms uÅ¾duotims:

```python
from transformers import AutoModelForCausalLM, AutoTokenizer, TrainingArguments
from peft import LoraConfig
from trl import SFTTrainer
from datasets import load_dataset

# Configuration for LoRA fine-tuning
peft_config = LoraConfig(
    r=16,
    lora_alpha=32,
    lora_dropout=0.05,
    bias="none",
    task_type="CAUSAL_LM",
    target_modules="all-linear"
)

# Training configuration optimized for efficiency
training_config = TrainingArguments(
    output_dir="./phi-4-mini-finetuned",
    learning_rate=5.0e-06,
    per_device_train_batch_size=4,
    gradient_accumulation_steps=1,
    num_train_epochs=1,
    bf16=True,
    gradient_checkpointing=True,
    warmup_ratio=0.2,
    save_steps=100
)

# Load model and tokenizer
model = AutoModelForCausalLM.from_pretrained(
    "microsoft/Phi-4-mini-instruct",
    torch_dtype=torch.bfloat16,
    trust_remote_code=True
)

tokenizer = AutoTokenizer.from_pretrained("microsoft/Phi-4-mini-instruct")
tokenizer.pad_token = tokenizer.unk_token
tokenizer.padding_side = 'right'

# Load and process dataset
train_dataset = load_dataset("HuggingFaceH4/ultrachat_200k", split="train_sft")

# Initialize trainer
trainer = SFTTrainer(
    model=model,
    args=training_config,
    peft_config=peft_config,
    train_dataset=train_dataset,
    max_seq_length=2048,
    tokenizer=tokenizer,
    packing=True
)

# Start fine-tuning
trainer.train()
```

### Specializuoti uÅ¾duoÄiÅ³ formatai

**Logikos uÅ¾duotims (Phi-4-reasoning-plus):**
```
<|im_start|>system<|im_sep|>
You are Phi, a language model trained by Microsoft to help users. Your role as an assistant involves thoroughly exploring questions through a systematic thinking process before providing the final precise and accurate solutions.

Please structure your response into two main sections:
<think>
{Thought section}
</think>
{Solution section}
<|im_end|>
<|im_start|>user<|im_sep|>
What is the derivative of x^2?
<|im_end|>
<|im_start|>assistant<|im_sep|>
```

**MatematinÄ—ms uÅ¾duotims (Phi-4-mini-reasoning):**
```
<|system|>
Your name is Phi, an AI math expert developed by Microsoft.
<|end|>
<|user|>
Solve this calculus problem: Find the integral of 2x + 3
<|end|>
<|assistant|>
```

### Mobilus diegimas su ONNX

```python
import onnxruntime as ort
import numpy as np

# Load ONNX model for mobile deployment
session = ort.InferenceSession("phi-4-mini-quantized.onnx")

# Prepare input
input_ids = tokenizer.encode("Hello, how are you?", return_tensors="np")

# Run inference
outputs = session.run(None, {"input_ids": input_ids})
predicted_ids = outputs[0]

# Decode response
response = tokenizer.decode(predicted_ids[0], skip_special_tokens=True)
```

## NaÅ¡umo rodikliai ir pasiekimai

Phi modeliÅ³ Å¡eima pasiekÄ— Ä¯spÅ«dingÅ³ rezultatÅ³ Ä¯vairiuose testuose, daÅ¾nai pranokdama daug didesnius modelius:

### Svarbiausi naÅ¡umo pasiekimai

**Matematinio samprotavimo meistriÅ¡kumas:**
- Phi-4 pasiekia 82,5% tikslumÄ… AIME 2025 (Matematikos olimpiados kvalifikacija)
- Phi-4-reasoning (14B) pranoksta DeepSeek-R1-Distill-70B (5 kartus didesnÄ¯) logikos testuose
- Phi-4-mini-reasoning (3.8B) prilygsta modeliams, kurie yra dvigubai didesni matematinio samprotavimo uÅ¾duotyse

**Efektyvumo pasiekimai:**
- Phi-3-Silica pasiekia 650 Å¾etonÅ³ per sekundÄ™, sunaudodamas tik 1,5W energijos
- Phi-4-mini (3.8B) pasiekia panaÅ¡Å³ naÅ¡umÄ… kaip daug didesni modeliai

**TestÅ³ rezultatai:**
- **MMLU (Masinis daugiatikslis kalbos supratimas)**: Konkurencingi rezultatai 57 akademinÄ—se srityse
- **HumanEval**: Stiprios kodo generavimo galimybÄ—s, ypaÄ Python kalboje
- **MGSM**: Daugiakalbis pradinÄ—s mokyklos matematikos problemÅ³ sprendimas
- **DROP**: SudÄ—tingos supratimo ir logikos uÅ¾duotys
- **SimpleQA**: FaktÅ³ tikslumo atsakymai

### ğŸ“Š ModeliÅ³ palyginimo matrica

| Modelis | Parametrai | Konteksto ilgis | PagrindinÄ—s stiprybÄ—s | Geriausi naudojimo atvejai |
|---------|------------|-----------------|-----------------------|----------------------------|
| **Phi-3-mini** | 3.8B | 4K/128K | Bendras efektyvumas | Mobilios programÄ—lÄ—s, paprasti pokalbiÅ³ robotai |
| **Phi-3.5-mini** | 3.8B | 128K | DaugiakalbÄ— parama | TarptautinÄ—s programos |
| **Phi-4-mini** | 3.8B | 128K | Patobulintas samprotavimas, funkcijÅ³ iÅ¡kvietimas | Verslo automatizavimas |
| **Phi-4-mini-reasoning** | 3.8B | 128K | Matematinis samprotavimas | Å vietimo platformos |
| **Phi-4** | 14B | 32K | SudÄ—tingas samprotavimas | Tyrimai, paÅ¾angi analizÄ— |
| **Phi-4-reasoning** | 14B | 32K/64K | Daugiapakopis samprotavimas | Mokslinis skaiÄiavimas |
| **Phi-4-reasoning-plus** | 14B | 32K | Maksimalus tikslumas samprotavime | KritiniÅ³ sprendimÅ³ priÄ—mimas |
| **Phi-4-multimodal** | 5.6B | Kintamas | Kalba, vaizdas, tekstas | Multimedijos programos |

## Modelio pasirinkimo vadovas

### Paprastoms programoms
- **Phi-3-mini**: Paprastas teksto generavimas, pagrindiniai klausimai ir atsakymai, greiti atsakymai
- **Phi-4-mini**: Patobulintas samprotavimas su funkcijÅ³ iÅ¡kvietimo galimybÄ—mis

### MatematinÄ—ms ir logikos uÅ¾duotims
- **Phi-4**: SudÄ—tingas matematikos problemÅ³ sprendimas ir samprotavimas
- **Phi-4-reasoning**: Daugiapakopis samprotavimas su iÅ¡samiais paaiÅ¡kinimais
- **Phi-4-reasoning-plus**: Maksimalus tikslumas kritinÄ—se logikos uÅ¾duotyse
- **Phi-4-mini-reasoning**: Efektyvus matematinis samprotavimas ribotÅ³ resursÅ³ aplinkoje

### MultimodalinÄ—ms programoms
- **Phi-3-vision**: Vaizdo ir teksto apdorojimo deriniai
- **Phi-4-multimodal**: IÅ¡samios kalbos, vaizdo ir teksto galimybÄ—s

### Ä®moniÅ³ diegimui
- **Phi-3-medium**: PaÅ¾angus kalbos supratimas verslo programoms
- **Phi-3-Silica**: Optimizuotas specifinÄ—ms techninÄ—s Ä¯rangos platformoms

## Diegimo platformos ir prieinamumas

### DebesÅ³ platformos
- **Azure AI Foundry**: Pilnai funkcionalus diegimas su verslo Ä¯rankiais
- **Hugging Face**: Atvirojo kodo modeliÅ³ saugykla ir bendruomenÄ—s iÅ¡tekliai
- **NVIDIA API Catalog**: MikroservisÅ³ diegimo galimybÄ—s

### VietinÄ—s kÅ«rimo sistemos
- **Ollama**: Lengva sistema vietiniam modeliÅ³ diegimui
- **ONNX Runtime**: Optimizuotas Ä¯vairioms techninÄ—s Ä¯rangos konfigÅ«racijoms  
- **DirectML**: Optimizuotas Windows naÅ¡umui
- **llama.cpp**: KryÅ¾minÄ—s platformos inferencijos variklis

### Mokymosi iÅ¡tekliai
- **Phi Portal**: Oficialus Microsoft Phi dokumentacijos centras
- **Phi Cookbook**: IÅ¡samÅ«s pavyzdÅ¾iai ir pamokos
- **TechninÄ—s ataskaitos**: IÅ¡samÅ«s moksliniai straipsniai arxiv
- **BendruomenÄ—s erdvÄ—s**: Hugging Face interaktyvÅ«s demonstraciniai pavyzdÅ¾iai

### PradÅ¾ia su Phi modeliais

#### KÅ«rimo platformos
1. **Azure AI Foundry**: Paprastas vietinis CLI ir modeliÅ³ valdymas.
2. **Hugging Face Transformers**: Greitas vietinis eksperimentavimas
3. **Ollama**: Paprastas vietinis diegimas testavimui

#### Mokymosi kelias
1. **Suprasti pagrindines sÄ…vokas**: IÅ¡studijuoti pagrindinius dizaino principus
2. **Eksperimentuoti su variantais**: IÅ¡bandyti skirtingus Phi modelius, kad suprastumÄ—te galimybes
3. **Praktikuoti Ä¯gyvendinimÄ…**: Diegti modelius testavimo aplinkose
4. **PlÄ—sti diegimÄ…**: Palaipsniui didinti naudojimÄ…, remiantis sÄ—kmingais pilotais

#### Geriausios praktikos
- **PradÄ—kite nuo maÅ¾o**: PradÄ—kite nuo Phi-mini modeliÅ³ pradiniam kÅ«rimui
- **Optimizuokite uÅ¾duotis**: Naudokite tinkamÄ… pokalbiÅ³ formatavimÄ… geriausiems rezultatams
- **StebÄ—kite naÅ¡umÄ…**: Sekite inferencijos greitÄ¯ ir tikslumo rodiklius
- **Apsvarstykite techninÄ™ Ä¯rangÄ…**: Suderinkite modelio dydÄ¯ su turimais skaiÄiavimo resursais

## IÅ¡vada

Microsoft Phi modeliÅ³ Å¡eima atspindi revoliucinÄ¯ poÅ¾iÅ«rÄ¯ Ä¯ AI modeliÅ³ dizainÄ…, parodant, kad maÅ¾esni, efektyvesni modeliai gali pasiekti Ä¯spÅ«dingÅ³ rezultatÅ³ Ä¯vairiose uÅ¾duotyse. DÄ—mesys aukÅ¡tos kokybÄ—s mokymo duomenims ir architektÅ«rinÄ—ms optimizacijoms leidÅ¾ia Phi Å¡eimai pasiÅ«lyti iÅ¡skirtines galimybes, Å¾ymiai sumaÅ¾inant skaiÄiavimo reikalavimus, palyginti su tradiciniais dideliais kalbos modeliais.

## Pagrindiniai mokymosi tikslai

1. Suprasti Microsoft Phi modeliÅ³ Å¡eimos dizaino filosofijÄ… ir evoliucijÄ… nuo Phi-1 iki Phi-4
2. Identifikuoti pagrindines inovacijas, Ä¯skaitant â€vadovÄ—lio kokybÄ—sâ€œ mokymÄ… ir architektÅ«rines optimizacijas
3. AtpaÅ¾inti skirtingÅ³ Phi variantÅ³ privalumus ir trÅ«kumus Ä¯vairiose diegimo situacijose
4. Taikyti Å¾inias, kad pasirinktumÄ—te tinkamus Phi modelius konkretiems naudojimo atvejams ir techninÄ—s Ä¯rangos apribojimams
5. Ä®gyvendinti optimizavimo technikas, kad Phi modeliai bÅ«tÅ³ diegiami ribotÅ³ resursÅ³ Ä¯renginiuose
6. PaaiÅ¡kinti Phi modeliÅ³ Å¡eimos architektÅ«rinius pranaÅ¡umus, palyginti su tradiciniais dideliais kalbos modeliais
7. Pasirinkti tinkamÄ… Phi variantÄ…, remiantis specifiniais programos reikalavimais ir techninÄ—s Ä¯rangos apribojimais
8. Ä®gyvendinti Phi modelius tiek debesÅ³, tiek kraÅ¡tiniÅ³ diegimo scenarijuose su optimizuotomis konfigÅ«racijomis
9. Taikyti kvantavimo ir optimizavimo technikas, kad pagerintumÄ—te Phi modeliÅ³ naÅ¡umÄ… tiksliniuose Ä¯renginiuose
10. Ä®vertinti kompromisus tarp modelio dydÅ¾io, naÅ¡umo ir galimybiÅ³ visoje Phi Å¡eimoje

## Kas toliau

- [02: Qwen Family Fundamentals](02.QwenFamily.md)

---

**AtsakomybÄ—s apribojimas**:  
Å is dokumentas buvo iÅ¡verstas naudojant AI vertimo paslaugÄ… [Co-op Translator](https://github.com/Azure/co-op-translator). Nors siekiame tikslumo, praÅ¡ome atkreipti dÄ—mesÄ¯, kad automatiniai vertimai gali turÄ—ti klaidÅ³ ar netikslumÅ³. Originalus dokumentas jo gimtÄ…ja kalba turÄ—tÅ³ bÅ«ti laikomas autoritetingu Å¡altiniu. Kritinei informacijai rekomenduojama naudoti profesionalÅ³ Å¾mogaus vertimÄ…. Mes neprisiimame atsakomybÄ—s uÅ¾ nesusipratimus ar neteisingus interpretavimus, atsiradusius dÄ—l Å¡io vertimo naudojimo.