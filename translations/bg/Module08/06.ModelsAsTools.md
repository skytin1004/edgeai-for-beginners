<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "8641f7baaf43de0f266276b64c5f5020",
  "translation_date": "2025-09-25T01:47:50+00:00",
  "source_file": "Module08/06.ModelsAsTools.md",
  "language_code": "bg"
}
-->
## –ü—Ä–µ–≥–ª–µ–¥

–¢—Ä–µ—Ç–∏—Ä–∞–π—Ç–µ AI –º–æ–¥–µ–ª–∏—Ç–µ –∫–∞—Ç–æ –º–æ–¥—É–ª–Ω–∏, –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, –∫–æ–∏—Ç–æ —Ä–∞–±–æ—Ç—è—Ç –¥–∏—Ä–µ–∫—Ç–Ω–æ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ—Ç–æ —Å Foundry Local. –¢–∞–∑–∏ —Å–µ—Å–∏—è –∞–∫—Ü–µ–Ω—Ç–∏—Ä–∞ –≤—ä—Ä—Ö—É –ø—Ä–∞–∫—Ç–∏—á–Ω–∏ —Ä–∞–±–æ—Ç–Ω–∏ –ø—Ä–æ—Ü–µ—Å–∏ –∑–∞ –∑–∞–ø–∞–∑–≤–∞–Ω–µ –Ω–∞ –ø–æ–≤–µ—Ä–∏—Ç–µ–ª–Ω–æ—Å—Ç—Ç–∞, –Ω–∏—Å–∫–∞ –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç –ø—Ä–∏ –∏–∑–≤–µ–∂–¥–∞–Ω–µ –∏ –∫–∞–∫ –¥–∞ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–∞—Ç–µ —Ç–µ–∑–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ —á—Ä–µ–∑ SDK, API –∏–ª–∏ CLI. –©–µ –Ω–∞—É—á–∏—Ç–µ —Å—ä—â–æ –∫–∞–∫ –¥–∞ –º–∞—â–∞–±–∏—Ä–∞—Ç–µ –∫—ä–º Azure AI Foundry, –∫–æ–≥–∞—Ç–æ –µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ.

> **üîÑ –ê–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞–Ω–æ –∑–∞ –º–æ–¥–µ—Ä–Ω–∏—è SDK**: –¢–æ–∑–∏ –º–æ–¥—É–ª –µ —Å—ä–æ–±—Ä–∞–∑–µ–Ω —Å –Ω–∞–π-–Ω–æ–≤–∏—Ç–µ –º–æ–¥–µ–ª–∏ –Ω–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ—Ç–æ Microsoft Foundry-Local –∏ —Å—ä–æ—Ç–≤–µ—Ç—Å—Ç–≤–∞ –Ω–∞ –∏–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–Ω–∞—Ç–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è, —Ä–µ–∞–ª–∏–∑–∏—Ä–∞–Ω–∞ –≤ `samples/06/`. –ü—Ä–∏–º–µ—Ä–∏—Ç–µ –≤–µ—á–µ –∏–∑–ø–æ–ª–∑–≤–∞—Ç –º–æ–¥–µ—Ä–Ω–∏—è `foundry-local-sdk` –∏ —É—Å—ä–≤—ä—Ä—à–µ–Ω—Å—Ç–≤–∞–Ω–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∑–∞ –∏–∑–±–æ—Ä –Ω–∞ –º–æ–¥–µ–ª–∏.

**üèóÔ∏è –û—Å–Ω–æ–≤–Ω–∏ –º–æ–º–µ–Ω—Ç–∏ –æ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞—Ç–∞:**
- **–ò–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–Ω–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –Ω–∞ –º–æ–¥–µ–ª–∏**: –ò–∑–±–æ—Ä –Ω–∞ –º–æ–¥–µ–ª–∏ –≤—ä–∑ –æ—Å–Ω–æ–≤–∞ –Ω–∞ –∫–ª—é—á–æ–≤–∏ –¥—É–º–∏ –º–µ–∂–¥—É –æ–±—â–∏, –ª–æ–≥–∏—á–µ—Å–∫–∏, –∫–æ–¥–æ–≤–∏ –∏ —Ç–≤–æ—Ä—á–µ—Å–∫–∏ –º–æ–¥–µ–ª–∏
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–æ–¥–µ—Ä–µ–Ω SDK**: –ò–∑–ø–æ–ª–∑–≤–∞ `FoundryLocalManager` —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ—Ç–∫—Ä–∏–≤–∞–Ω–µ –Ω–∞ —É—Å–ª—É–≥–∏
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞ —Å—Ä–µ–¥–∞—Ç–∞**: –ì—ä–≤–∫–∞–≤–æ –∑–∞–¥–∞–≤–∞–Ω–µ –Ω–∞ –º–æ–¥–µ–ª–∏ —á—Ä–µ–∑ –ø—Ä–æ–º–µ–Ω–ª–∏–≤–∏ –Ω–∞ —Å—Ä–µ–¥–∞—Ç–∞
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞ –∑–¥—Ä–∞–≤–µ—Ç–æ**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —É—Å–ª—É–≥–∏—Ç–µ –∏ –Ω–∞–ª–∏—á–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ –º–æ–¥–µ–ª–∏—Ç–µ
- **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç –∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ**: –ò–∑—á–µ—Ä–ø–∞—Ç–µ–ª–Ω–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –≥—Ä–µ—à–∫–∏ –∏ –º–µ—Ö–∞–Ω–∏–∑–º–∏ –∑–∞ —Ä–µ–∑–µ—Ä–≤–∏—Ä–∞–Ω–µ

**üìÅ –õ–æ–∫–∞–ª–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `samples/06/router.py` - –ò–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–µ–Ω –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä –Ω–∞ –º–æ–¥–µ–ª–∏ —Å –∏–∑–±–æ—Ä –≤—ä–∑ –æ—Å–Ω–æ–≤–∞ –Ω–∞ –∫–ª—é—á–æ–≤–∏ –¥—É–º–∏
- `samples/06/model_router.ipynb` - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏ –ø—Ä–∏–º–µ—Ä–∏ –∏ –±–µ–Ω—á–º–∞—Ä–∫–æ–≤–µ
- `samples/06/README.md` - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∑–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ —É–ø–æ—Ç—Ä–µ–±–∞

–†–µ—Ñ–µ—Ä–µ–Ω—Ü–∏–∏:
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∑–∞ Foundry Local: https://learn.microsoft.com/en-us/azure/ai-foundry/foundry-local/
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å—ä—Å SDK –∑–∞ –∏–∑–≤–µ–∂–¥–∞–Ω–µ: https://learn.microsoft.com/en-us/azure/ai-foundry/foundry-local/how-to/how-to-integrate-with-inference-sdks
- –ö–æ–º–ø–∏–ª–∏—Ä–∞–Ω–µ –Ω–∞ –º–æ–¥–µ–ª–∏ Hugging Face: https://learn.microsoft.com/en-us/azure/ai-foundry/foundry-local/how-to/how-to-compile-hugging-face-models

## –ü—Ä–µ–≥–ª–µ–¥

–¢—Ä–µ—Ç–∏—Ä–∞–π—Ç–µ AI –º–æ–¥–µ–ª–∏—Ç–µ –∫–∞—Ç–æ –º–æ–¥—É–ª–Ω–∏, –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, –∫–æ–∏—Ç–æ —Ä–∞–±–æ—Ç—è—Ç –¥–∏—Ä–µ–∫—Ç–Ω–æ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ—Ç–æ —Å Foundry Local. –¢–∞–∑–∏ —Å–µ—Å–∏—è –∞–∫—Ü–µ–Ω—Ç–∏—Ä–∞ –≤—ä—Ä—Ö—É –ø—Ä–∞–∫—Ç–∏—á–Ω–∏ —Ä–∞–±–æ—Ç–Ω–∏ –ø—Ä–æ—Ü–µ—Å–∏ –∑–∞ –∑–∞–ø–∞–∑–≤–∞–Ω–µ –Ω–∞ –ø–æ–≤–µ—Ä–∏—Ç–µ–ª–Ω–æ—Å—Ç—Ç–∞, –Ω–∏—Å–∫–∞ –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç –ø—Ä–∏ –∏–∑–≤–µ–∂–¥–∞–Ω–µ –∏ –∫–∞–∫ –¥–∞ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–∞—Ç–µ —Ç–µ–∑–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ —á—Ä–µ–∑ SDK, API –∏–ª–∏ CLI. –©–µ –Ω–∞—É—á–∏—Ç–µ —Å—ä—â–æ –∫–∞–∫ –¥–∞ –º–∞—â–∞–±–∏—Ä–∞—Ç–µ –∫—ä–º Azure AI Foundry, –∫–æ–≥–∞—Ç–æ –µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ.

–†–µ—Ñ–µ—Ä–µ–Ω—Ü–∏–∏:
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∑–∞ Foundry Local: https://learn.microsoft.com/en-us/azure/ai-foundry/foundry-local/
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å—ä—Å SDK –∑–∞ –∏–∑–≤–µ–∂–¥–∞–Ω–µ: https://learn.microsoft.com/en-us/azure/ai-foundry/foundry-local/how-to/how-to-integrate-with-inference-sdks
- –ö–æ–º–ø–∏–ª–∏—Ä–∞–Ω–µ –Ω–∞ –º–æ–¥–µ–ª–∏ Hugging Face: https://learn.microsoft.com/en-us/azure/ai-foundry/foundry-local/how-to/how-to-compile-hugging-face-models

## –¶–µ–ª–∏ –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ—Ç–æ
- –ü—Ä–æ–µ–∫—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –º–æ–¥–µ–ª–∏ –∫–∞—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ—Ç–æ
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á—Ä–µ–∑ REST API, —Å—ä–≤–º–µ—Å—Ç–∏–º —Å OpenAI, –∏–ª–∏ SDK
- –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–∞–Ω–µ –Ω–∞ –º–æ–¥–µ–ª–∏ –∑–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∏ –∑–∞ –¥–æ–º–µ–π–Ω–∞ —Å–ª—É—á–∞–∏
- –ü–ª–∞–Ω–∏—Ä–∞–Ω–µ –∑–∞ —Ö–∏–±—Ä–∏–¥–Ω–æ –º–∞—â–∞–±–∏—Ä–∞–Ω–µ –∫—ä–º Azure AI Foundry

## –ß–∞—Å—Ç 1: –ò–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–µ–Ω –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä –Ω–∞ –º–æ–¥–µ–ª–∏ (–º–æ–¥–µ—Ä–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)

–¶–µ–ª: –†–µ–∞–ª–∏–∑–∏—Ä–∞–Ω–µ –Ω–∞ –∏–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–µ–Ω –∏–∑–±–æ—Ä –Ω–∞ –º–æ–¥–µ–ª–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –≤—ä–∑ –æ—Å–Ω–æ–≤–∞ –Ω–∞ —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ—Ç–æ –Ω–∞ –∑–∞—è–≤–∫–∞—Ç–∞.

> **üìã –ó–∞–±–µ–ª–µ–∂–∫–∞**: –¢–∞–∑–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—ä–æ—Ç–≤–µ—Ç—Å—Ç–≤–∞ –Ω–∞ –º–æ–¥–µ–ª–∏—Ç–µ, –∏–∑–ø–æ–ª–∑–≤–∞–Ω–∏ –≤ `samples/06/router.py` —Å —É—Å—ä–≤—ä—Ä—à–µ–Ω—Å—Ç–≤–∞–Ω –∏–∑–±–æ—Ä –Ω–∞ –º–æ–¥–µ–ª–∏ –≤—ä–∑ –æ—Å–Ω–æ–≤–∞ –Ω–∞ –∫–ª—é—á–æ–≤–∏ –¥—É–º–∏.

–°—Ç—ä–ø–∫–∞ 1) –î–µ—Ñ–∏–Ω–∏—Ä–∞–Ω–µ –Ω–∞ –º–æ–¥–µ—Ä–µ–Ω –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä –Ω–∞ –º–æ–¥–µ–ª–∏ —Å FoundryLocalManager  
```python
# router/intelligent_router.py
from foundry_local import FoundryLocalManager
from openai import OpenAI
from typing import Dict, Any, Optional
import os
import json

class ModelRouter:
    """Intelligent model router that selects appropriate models for different task types."""
    
    def __init__(self):
        self.client = None
        self.base_url = None
        self.tools = self._load_tool_registry()
        self._initialize_client()
    
    def _load_tool_registry(self) -> Dict[str, Dict[str, Any]]:
        """Load tool registry from environment or use defaults."""
        default_tools = {
            "general": {
                "model": os.environ.get("GENERAL_MODEL", "phi-4-mini"),
                "notes": "Fast general-purpose chat and Q&A",
                "temperature": 0.7
            },
            "reasoning": {
                "model": os.environ.get("REASONING_MODEL", "deepseek-r1-distill-qwen-7b"),
                "notes": "Step-by-step analysis and logical reasoning",
                "temperature": 0.3
            },
            "code": {
                "model": os.environ.get("CODE_MODEL", "qwen2.5-7b-instruct"),
                "notes": "Code generation, debugging, and technical tasks",
                "temperature": 0.2
            },
            "creative": {
                "model": os.environ.get("CREATIVE_MODEL", "phi-4-mini"),
                "notes": "Creative writing and storytelling",
                "temperature": 0.9
            }
        }
        
        # Check for environment override
        tools_env = os.environ.get("TOOL_REGISTRY")
        if tools_env:
            try:
                return json.loads(tools_env)
            except json.JSONDecodeError:
                print("Warning: Invalid TOOL_REGISTRY JSON, using defaults")
        
        return default_tools
```
  
–°—Ç—ä–ø–∫–∞ 2) –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–∞–Ω–µ –Ω–∞ –∫–ª–∏–µ–Ω—Ç —Å –º–æ–¥–µ—Ä–µ–Ω SDK –∏ –æ—Ç–∫—Ä–∏–≤–∞–Ω–µ –Ω–∞ —É—Å–ª—É–≥–∏  
```python
    def _initialize_client(self):
        """Initialize OpenAI client with Foundry Local or fallback configuration."""
        try:
            from foundry_local import FoundryLocalManager
            # Try to use any available model for client initialization
            first_model = next(iter(self.tools.values()))["model"]
            manager = FoundryLocalManager(first_model)
            
            self.client = OpenAI(
                base_url=manager.endpoint,
                api_key=manager.api_key
            )
            self.base_url = manager.endpoint
            print(f"‚úÖ Foundry Local SDK initialized")
        except Exception as e:
            print(f"Warning: Could not use Foundry SDK ({e}), falling back to manual configuration")
            # Fallback to manual configuration
            self.base_url = os.environ.get("BASE_URL", "http://localhost:8000")
            api_key = os.environ.get("API_KEY", "")
            
            self.client = OpenAI(
                base_url=f"{self.base_url}/v1",
                api_key=api_key
            )
            print(f"Initialized manual configuration at {self.base_url}")
    
    def select_tool(self, user_query: str) -> str:
        """Select the most appropriate tool based on the user query."""
        query_lower = user_query.lower()
        
        # Code-related keywords
        code_keywords = ["code", "python", "function", "class", "method", "bug", "debug", 
                        "programming", "script", "algorithm", "implementation", "refactor"]
        if any(keyword in query_lower for keyword in code_keywords):
            return "code"
        
        # Reasoning keywords
        reasoning_keywords = ["why", "how", "explain", "step-by-step", "reason", "analyze", 
                             "think", "logic", "because", "cause", "compare", "evaluate"]
        if any(keyword in query_lower for keyword in reasoning_keywords):
            return "reasoning"
        
        # Creative keywords
        creative_keywords = ["story", "poem", "creative", "imagine", "write", "tale", 
                           "narrative", "fiction", "character", "plot"]
        if any(keyword in query_lower for keyword in creative_keywords):
            return "creative"
        
        # Default to general
        return "general"
    
    def chat(self, model: str, content: str, max_tokens: int = 300, temperature: Optional[float] = None) -> str:
        """Send chat completion request to the specified model."""
        try:
            params = {
                "model": model,
                "messages": [{"role": "user", "content": content}],
                "max_tokens": max_tokens
            }
            
            if temperature is not None:
                params["temperature"] = temperature
            
            response = self.client.chat.completions.create(**params)
            return response.choices[0].message.content
        except Exception as e:
            return f"Error generating response with model {model}: {str(e)}"
```
  
–°—Ç—ä–ø–∫–∞ 3) –†–µ–∞–ª–∏–∑–∏—Ä–∞–Ω–µ –Ω–∞ –∏–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–Ω–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∏ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ (–≤–∏–∂—Ç–µ `samples/06/router.py`)  
```python
    def route_and_run(self, prompt: str) -> Dict[str, Any]:
        """Route the prompt to the appropriate model and generate response."""
        tool_key = self.select_tool(prompt)
        tool_config = self.tools[tool_key]
        model = tool_config["model"]
        temperature = tool_config.get("temperature", 0.7)
        
        print(f"üéØ Selected tool: {tool_key} (model: {model})")
        
        answer = self.chat(
            model=model, 
            content=prompt, 
            max_tokens=400, 
            temperature=temperature
        )
        
        return {
            "tool": tool_key,
            "model": model,
            "tool_description": tool_config["notes"],
            "temperature": temperature,
            "answer": answer
        }
    
    def check_service_health(self) -> Dict[str, Any]:
        """Check Foundry Local service health and available models."""
        try:
            models_response = self.client.models.list()
            available_models = [model.id for model in models_response.data]
            
            return {
                "status": "healthy",
                "base_url": self.base_url,
                "available_models": available_models,
                "tools_configured": list(self.tools.keys())
            }
        except Exception as e:
            return {
                "status": "error",
                "base_url": self.base_url,
                "error": str(e)
            }

if __name__ == "__main__":
    # Ensure: foundry model run phi-4-mini
    router = ModelRouter()
    
    # Check health
    health = router.check_service_health()
    print(f"Service Health: {json.dumps(health, indent=2)}")
    
    # Test different query types
    queries = [
        "Write a Python function to calculate fibonacci numbers",  # -> code
        "Explain step-by-step why the sky is blue",  # -> reasoning
        "Tell me a creative story about AI",  # -> creative
        "What's the weather like today?"  # -> general
    ]
    
    for query in queries:
        result = router.route_and_run(query)
        print(f"\nQuery: {query}")
        print(f"Selected: {result['tool']} -> {result['model']}")
        print(f"Answer: {result['answer'][:100]}...")
```
  

## –ß–∞—Å—Ç 2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–æ–¥–µ—Ä–µ–Ω SDK (—Å—Ç—ä–ø–∫–∞ –ø–æ —Å—Ç—ä–ø–∫–∞)

–¶–µ–ª: –ò–∑–ø–æ–ª–∑–≤–∞–Ω–µ –Ω–∞ Foundry Local SDK —Å OpenAI Python SDK –∑–∞ –±–µ–∑–ø—Ä–æ–±–ª–µ–º–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è.

–°—Ç—ä–ø–∫–∞ 1) –ò–Ω—Å—Ç–∞–ª–∏—Ä–∞–Ω–µ –Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏  
```cmd
cd Module08
.\.venv\Scripts\activate
pip install foundry-local-sdk openai
```
  
–°—Ç—ä–ø–∫–∞ 2) –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞–Ω–µ –Ω–∞ —Å—Ä–µ–¥–∞—Ç–∞ (–ø–æ –∏–∑–±–æ—Ä - –≤–∏–∂—Ç–µ `samples/06/README.md`)  
```cmd
REM Override default models per tool
set GENERAL_MODEL=phi-4-mini
set REASONING_MODEL=deepseek-r1-distill-qwen-7b
set CODE_MODEL=qwen2.5-7b-instruct
REM Or provide a full JSON registry
set TOOL_REGISTRY={"general":{"model":"phi-4-mini"},"reasoning":{"model":"deepseek-r1-distill-qwen-7b"}}
```
  
–°—Ç—ä–ø–∫–∞ 3) –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–æ–¥–µ—Ä–µ–Ω SDK  
```python
# modern_sdk_demo.py
from foundry_local import FoundryLocalManager
from openai import OpenAI
import sys

def main():
    """Demonstrate modern SDK integration."""
    try:
        # Initialize with FoundryLocalManager
        alias = "phi-4-mini"
        manager = FoundryLocalManager(alias)
        
        # Create OpenAI client using Foundry Local endpoint
        client = OpenAI(
            base_url=manager.endpoint,
            api_key=manager.api_key
        )
        
        # Get model info
        model_info = manager.get_model_info(alias)
        print(f"Using model: {model_info.id}")
        
        # Make request with streaming
        stream = client.chat.completions.create(
            model=model_info.id,
            messages=[{"role": "user", "content": "Explain edge AI benefits in one paragraph."}],
            stream=True,
            max_tokens=200
        )
        
        print("Response: ", end="")
        for chunk in stream:
            if chunk.choices[0].delta.content:
                print(chunk.choices[0].delta.content, end="", flush=True)
        print()
        
    except Exception as e:
        print(f"Error: {e}")
        print("Ensure Foundry Local is running with: foundry model run phi-4-mini")
        sys.exit(1)

if __name__ == "__main__":
    main()
```
  

## –ß–∞—Å—Ç 3: –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–∞–Ω–µ –∑–∞ –¥–æ–º–µ–π–Ω (—Å—Ç—ä–ø–∫–∞ –ø–æ —Å—Ç—ä–ø–∫–∞)

–¶–µ–ª: –ü—Ä–∏—Å–ø–æ—Å–æ–±—è–≤–∞–Ω–µ –Ω–∞ –∏–∑—Ö–æ–¥–∞ –∑–∞ –¥–æ–º–µ–π–Ω —á—Ä–µ–∑ —à–∞–±–ª–æ–Ω–∏ –∑–∞ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –∏ JSON —Å—Ö–µ–º–∞.

–°—Ç—ä–ø–∫–∞ 1) –°—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ —à–∞–±–ª–æ–Ω –∑–∞ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –∑–∞ –¥–æ–º–µ–π–Ω  
```python
# domain/templates.py
BUSINESS_ANALYST_SYSTEM = """
You are a senior business analyst. Provide:
1) Key insights
2) Risks
3) Next steps
Respond in valid JSON with fields: insights, risks, next_steps.
"""
```
  
–°—Ç—ä–ø–∫–∞ 2) –ù–∞–ª–∞–≥–∞–Ω–µ –Ω–∞ JSON –∏–∑—Ö–æ–¥  
```python
# domain/analyst.py
import requests, os, json

BASE_URL = os.getenv("OPENAI_BASE_URL", "http://localhost:8000/v1")
API_KEY = os.getenv("OPENAI_API_KEY", "local-key")
HEADERS = {"Content-Type":"application/json","Authorization":f"Bearer {API_KEY}"}

from domain.templates import BUSINESS_ANALYST_SYSTEM

def analyze(text: str) -> dict:
    messages = [
        {"role":"system","content": BUSINESS_ANALYST_SYSTEM},
        {"role":"user","content": f"Analyze this business text:\n{text}"}
    ]
    r = requests.post(f"{BASE_URL}/chat/completions", json={
    "model":"phi-4-mini",
        "messages": messages,
        "response_format": {"type":"json_object"},
        "temperature": 0.3
    }, headers=HEADERS, timeout=60)
    r.raise_for_status()
    # Parse JSON content
    content = r.json()["choices"][0]["message"]["content"]
    return json.loads(content)

if __name__ == "__main__":
    print(analyze("Sales dipped 12% in Q3 due to supply constraints and marketing cuts."))
```
  

## –ß–∞—Å—Ç 4: –û—Ñ–ª–∞–π–Ω –∏ —Å–∏–≥—É—Ä–Ω–æ—Å—Ç (—Å—Ç—ä–ø–∫–∞ –ø–æ —Å—Ç—ä–ø–∫–∞)

–¶–µ–ª: –û—Å–∏–≥—É—Ä—è–≤–∞–Ω–µ –Ω–∞ –ø–æ–≤–µ—Ä–∏—Ç–µ–ª–Ω–æ—Å—Ç –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç –ø—Ä–∏ —Ä–∞–±–æ—Ç–∞ —Å –º–æ–¥–µ–ª–∏ –∫–∞—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –ª–æ–∫–∞–ª–Ω–æ.

–°—Ç—ä–ø–∫–∞ 1) –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª–Ω–æ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ –∏ –≤–∞–ª–∏–¥–∏—Ä–∞–Ω–µ –Ω–∞ –ª–æ–∫–∞–ª–Ω–∏—è –∫—Ä–∞–π  
```cmd
foundry model run phi-4-mini
curl http://localhost:8000/v1/models
```
  
–°—Ç—ä–ø–∫–∞ 2) –ü–æ—á–∏—Å—Ç–≤–∞–Ω–µ –Ω–∞ –≤—Ö–æ–¥–Ω–∏—Ç–µ –¥–∞–Ω–Ω–∏  
```python
# security/sanitize.py
import re
EMAIL_RE = re.compile(r"[\w\.-]+@[\w\.-]+")
PHONE_RE = re.compile(r"\+?\d[\d\s\-]{7,}\d")

def sanitize(text: str) -> str:
    text = EMAIL_RE.sub("[REDACTED_EMAIL]", text)
    text = PHONE_RE.sub("[REDACTED_PHONE]", text)
    return text
```
  
–°—Ç—ä–ø–∫–∞ 3) –§–ª–∞–≥ –∑–∞ –ª–æ–∫–∞–ª–Ω–∞ —Ä–∞–±–æ—Ç–∞ –∏ –ª–æ–≥–≤–∞–Ω–µ  
```python
# security/local_only.py
import os, json, time
LOG = os.getenv("MODELS_AS_TOOLS_LOG", "./tools_logs.jsonl")

def record(event: dict):
    with open(LOG, "a", encoding="utf-8") as f:
        f.write(json.dumps(event) + "\n")

# Usage before each call
def before_call(tool_name, payload):
    record({"ts": time.time(), "tool": tool_name, "event": "before_call"})

# After each call
def after_call(tool_name, result):
    record({"ts": time.time(), "tool": tool_name, "event": "after_call"})
```
  

## –ß–∞—Å—Ç 5: –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–æ –≤–Ω–µ–¥—Ä—è–≤–∞–Ω–µ –∏ –º–∞—â–∞–±–∏—Ä–∞–Ω–µ

–¶–µ–ª: –í–Ω–µ–¥—Ä—è–≤–∞–Ω–µ –Ω–∞ –∏–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Azure AI Foundry.

> **üìã –ó–∞–±–µ–ª–µ–∂–∫–∞**: –õ–æ–∫–∞–ª–Ω–∞—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ `samples/06/model_router.ipynb` –≤–∫–ª—é—á–≤–∞ –∏–∑—á–µ—Ä–ø–∞—Ç–µ–ª–Ω–∏ –ø—Ä–∏–º–µ—Ä–∏ –∑–∞ –º–æ–¥–µ–ª–∏ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–æ –≤–Ω–µ–¥—Ä—è–≤–∞–Ω–µ.

–°—Ç—ä–ø–∫–∞ 1) –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–≤–∏–∂—Ç–µ `samples/06/router.py`)  
```python
# production/router.py
from router.intelligent_router import ModelRouter
import json
import time
import sys

class ProductionModelRouter(ModelRouter):
    """Production-ready model router with monitoring and logging."""
    
    def __init__(self):
        super().__init__()
        self.request_count = 0
        self.error_count = 0
        self.start_time = time.time()
    
    def route_and_run_with_monitoring(self, prompt: str) -> Dict[str, Any]:
        """Route with comprehensive monitoring and error handling."""
        start_time = time.time()
        self.request_count += 1
        
        try:
            result = self.route_and_run(prompt)
            processing_time = time.time() - start_time
            
            # Log successful request
            self._log_request({
                "status": "success",
                "tool": result["tool"],
                "model": result["model"],
                "processing_time": processing_time,
                "timestamp": time.strftime("%Y-%m-%d %H:%M:%S")
            })
            
            result["processing_time"] = processing_time
            return result
            
        except Exception as e:
            self.error_count += 1
            error_result = {
                "status": "error",
                "error": str(e),
                "processing_time": time.time() - start_time,
                "timestamp": time.strftime("%Y-%m-%d %H:%M:%S")
            }
            
            self._log_request(error_result)
            return error_result
    
    def _log_request(self, data: Dict[str, Any]):
        """Log request data for monitoring."""
        print(f"üìä {json.dumps(data)}")
    
    def get_stats(self) -> Dict[str, Any]:
        """Get router statistics."""
        uptime = time.time() - self.start_time
        return {
            "uptime_seconds": uptime,
            "total_requests": self.request_count,
            "error_count": self.error_count,
            "success_rate": (self.request_count - self.error_count) / max(1, self.request_count),
            "requests_per_minute": self.request_count / max(1, uptime / 60)
        }

def main():
    """Production router demo."""
    router = ProductionModelRouter()
    
    # Health check
    health = router.check_service_health()
    if health["status"] == "error":
        print(f"‚ùå Service health check failed: {health['error']}")
        sys.exit(1)
    
    print(f"‚úÖ Service healthy with {len(health['available_models'])} models")
    
    # Process user query
    user_prompt = " ".join(sys.argv[1:]) or "Write three benefits of on-device AI in JSON format."
    print(f"\nüéØ Processing: {user_prompt}")
    
    result = router.route_and_run_with_monitoring(user_prompt)
    
    if result.get("status") == "error":
        print(f"‚ùå Error: {result['error']}")
    else:
        print(f"\nüìã Result:")
        print(f"Tool: {result['tool']} -> Model: {result['model']}")
        print(f"Processing Time: {result['processing_time']:.2f}s")
        print(f"Answer: {result['answer']}")
    
    # Show stats
    stats = router.get_stats()
    print(f"\nüìä Statistics: {json.dumps(stats, indent=2)}")

if __name__ == "__main__":
    main()
```
  

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω—Ç—Ä–æ–ª–µ–Ω —Å–ø–∏—Å—ä–∫
- [ ] –†–µ–∞–ª–∏–∑–∏—Ä–∞–Ω–µ –Ω–∞ –∏–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–µ–Ω –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä –Ω–∞ –º–æ–¥–µ–ª–∏ —Å –∏–∑–±–æ—Ä –≤—ä–∑ –æ—Å–Ω–æ–≤–∞ –Ω–∞ –∫–ª—é—á–æ–≤–∏ –¥—É–º–∏ (`samples/06/router.py`)
- [ ] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞–Ω–µ –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–∞–Ω–∏ –º–æ–¥–µ–ª–∏ (–æ–±—â–∏, –ª–æ–≥–∏—á–µ—Å–∫–∏, –∫–æ–¥–æ–≤–∏, —Ç–≤–æ—Ä—á–µ—Å–∫–∏)
- [ ] –¢–µ—Å—Ç–≤–∞–Ω–µ –Ω–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏—è Jupyter notebook (`samples/06/model_router.ipynb`)
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞ –º–æ–¥–µ–ª–∏, –±–∞–∑–∏—Ä–∞–Ω–∞ –Ω–∞ —Å—Ä–µ–¥–∞
- [ ] –†–µ–∞–ª–∏–∑–∏—Ä–∞–Ω–µ –Ω–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞ –∑–¥—Ä–∞–≤–µ—Ç–æ –Ω–∞ —É—Å–ª—É–≥–∏—Ç–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –≥—Ä–µ—à–∫–∏
- [ ] –í–Ω–µ–¥—Ä—è–≤–∞–Ω–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä —Å –∏–∑—á–µ—Ä–ø–∞—Ç–µ–ª–Ω–æ –ª–æ–≥–≤–∞–Ω–µ

## –õ–æ–∫–∞–ª–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–∞ –ø—Ä–∏–º–µ—Ä

–ò–∑–ø—ä–ª–Ω–µ—Ç–µ –ø—ä–ª–Ω–∞—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:  
```cmd
cd Module08
.\.venv\Scripts\activate

REM Start required models
foundry model run phi-4-mini
foundry model run qwen2.5-7b-instruct
foundry model run deepseek-r1-distill-qwen-7b

REM Test the intelligent router
python samples\06\router.py "Write a Python function to sort a list"
python samples\06\router.py "Explain step-by-step how bubble sort works"
python samples\06\router.py "Tell me a creative story about robots"

REM Explore the interactive notebook
jupyter notebook samples/06/model_router.ipynb
```
  

## –†–µ—Ñ–µ—Ä–µ–Ω—Ü–∏–∏ –∏ —Å–ª–µ–¥–≤–∞—â–∏ —Å—Ç—ä–ø–∫–∏
- **–õ–æ–∫–∞–ª–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è**: `samples/06/` - –ü—ä–ª–µ–Ω –∏–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–µ–Ω –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä —Å –ø–æ–¥–¥—Ä—ä–∂–∫–∞ –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏
- **–ü—Ä–∏–º–µ—Ä–∏ –æ—Ç Microsoft**: [Hello Foundry Local](https://github.com/microsoft/Foundry-Local/tree/main/samples/python/hello-foundry-local)
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∑–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å—ä—Å SDK –∑–∞ –∏–∑–≤–µ–∂–¥–∞–Ω–µ](https://learn.microsoft.com/en-us/azure/ai-foundry/foundry-local/how-to/how-to-integrate-with-inference-sdks)
- **–£—Å—ä–≤—ä—Ä—à–µ–Ω—Å—Ç–≤–∞–Ω–∏ –º–æ–¥–µ–ª–∏**: –ò–∑—Å–ª–µ–¥–≤–∞–π—Ç–µ –∏–∑–≤–∏–∫–≤–∞–Ω–µ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∞–≥–µ–Ω—Ç–∏ –≤ –ú–æ–¥—É–ª 5

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

Foundry Local –ø–æ–∑–≤–æ–ª—è–≤–∞ –Ω–∞–¥–µ–∂–¥–µ–Ω AI –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ—Ç–æ, –∫—ä–¥–µ—Ç–æ –º–æ–¥–µ–ª–∏—Ç–µ —Å–µ –ø—Ä–µ–≤—Ä—ä—â–∞—Ç –≤ –∏–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–Ω–∏, —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–∞–Ω–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏. –° –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ–Ω –∏–∑–±–æ—Ä –Ω–∞ –º–æ–¥–µ–ª–∏, –∏–∑—á–µ—Ä–ø–∞—Ç–µ–ª–µ–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –≥–æ—Ç–æ–≤–∏ –∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏, –µ–∫–∏–ø–∏—Ç–µ –º–æ–≥–∞—Ç –¥–∞ —Å—ä–∑–¥–∞–≤–∞—Ç —Å–ª–æ–∂–Ω–∏ AI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∫–æ–∏—Ç–æ —Å–µ –∞–¥–∞–ø—Ç–∏—Ä–∞—Ç –∫—ä–º —Ä–∞–∑–ª–∏—á–Ω–∏ —Ç–∏–ø–æ–≤–µ –∑–∞–¥–∞—á–∏, –∫–∞—Ç–æ —Å—ä—â–µ–≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–ø–∞–∑–≤–∞—Ç –ø–æ–≤–µ—Ä–∏—Ç–µ–ª–Ω–æ—Å—Ç—Ç–∞ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–Ω–æ—Å—Ç—Ç–∞. –ü–æ–∫–∞–∑–∞–Ω–∏—è—Ç —Ç—É–∫ –º–æ–¥–µ–ª –Ω–∞ –∏–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–µ–Ω –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—è –æ—Å–Ω–æ–≤–∞ –∑–∞ –∏–∑–≥—Ä–∞–∂–¥–∞–Ω–µ –Ω–∞ —Å–ª–æ–∂–Ω–∏ AI —Å–∏—Å—Ç–µ–º–∏, –∫–æ–∏—Ç–æ –º–æ–≥–∞—Ç –¥–∞ —Å–µ –º–∞—â–∞–±–∏—Ä–∞—Ç –æ—Ç –ª–æ–∫–∞–ª–Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –¥–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–æ –≤–Ω–µ–¥—Ä—è–≤–∞–Ω–µ.

---

